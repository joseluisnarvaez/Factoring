<ui:composition template="/WEB-INF/template/Template.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	
>
   <ui:define name="title">ArmusSpa</ui:define>
   <script src="../resources/js/clientes.js"></script>
	
    <ui:define name="content">
	<div class="contenido">
		<h3>Buscar Clientes</h3>

	
		<div class="formulario tablaCentro">
			<h:form>
				<div class="form-group">
					<label for="exampleFormControlInput1">Nombre</label> <h:inputText
						type="text" class="form-control" id="nombre"  value="#{ingresoClienteBeans.to.nombre}"
						placeholder="Ingrese el nombre del Cliente"/>
				</div>
				<div class="form-group">
					<label for="exampleFormControlInput1">RUT</label>
					 <h:inputText
						type="text" class="form-control" id="rut" required= "true"
						oninput="checkRut(this)" value="#{ingresoClienteBeans.to.rut}" placeholder="Ingrese el RUT del Cliente"/>
				</div>
				<div class="botones-derecha">
					<p:commandButton styleClass="btn btn-primary" value="buscar"  action="#{ingresoClienteBeans.buscar}" process="@this"/>
				</div>
				
			</h:form>
			
		</div>
		
	
		<div >
				<h:form id= "tabla">
					<p:dataTable  tableStyleClass="table table-striped"  emptyMessage="No hay clientes que mostrar" 
					 id="tablaexport" var="item" value="#{ingresoClienteBeans.to.listaClientes}" paginator="true" paginatorPosition="bottom" rowIndexVar="i" rows="10">
						
						<p:column headerText="#"  exportable="false">
							<h:outputText value="#{i+1}" />
						</p:column>
						
						<p:column headerText="Nombre" sortBy="#{item.nombreCompleto}">
							<h:outputText value="#{item.nombreCompleto}" />
						</p:column>
						<p:column headerText="Rut" sortBy="#{item.rutDb}">
							<h:outputText value="#{item.rutDb} - #{item.dv_cliente} " />
						</p:column>
						<p:column headerText="Banco" sortBy="#{item.banco}">
							<h:outputText value="#{item.banco.glosa}" />
						</p:column>
						<p:column headerText="Cuenta Corriente" sortBy="#{item.c_corriente}">
							<h:outputText value="#{item.c_corriente}" />
						</p:column>
						<p:column headerText="Monto Max. Por Cliente" sortBy="#{item.monto_maximo_prestamo}">
							<h:outputText value="#{item.monto_maximo_prestamo}" />
						</p:column>
						<p:column headerText="Modificar" exportable="false" >
							<p:commandLink styleClass="fa fa-pencil" update=":tabla" actionListener="#{ingresoClienteBeans.buscarClienteID(item.idClientes)}"  oncomplete="PF('dlg2').show();" />
						</p:column>
						<p:column headerText="Eliminar" exportable="false" >
							<p:commandLink styleClass="fa fa-trash" actionListener="#{ingresoClienteBeans.eliminaCliente(item.idClientes)}" update=":tabla" /> 
						</p:column>
					</p:dataTable>

					<h:commandLink>

						<p:button styleClass="btn btn-primary"  value="Exportar PDF" />
						<p:dataExporter  type="pdf" target="tablaexport" fileName="consulta"
							pageOnly="true" />
					</h:commandLink>
					<h:commandLink>

						<p:button styleClass="btn btn-primary"  value="Exportar Excel" />
						<p:dataExporter  type="xls" target="tablaexport" fileName="consulta"
							pageOnly="true" />
					</h:commandLink>

				</h:form>
			</div>


	</div>

			<p:dialog header="Actualiza Cliente" widgetVar="dlg2" modal="true" >
					<h:form method="post" id="actualizaCliente" action="#">
						 
							<div class="form-group">
								<label for="exampleFormControlInput1">Nombre</label>
								  <h:inputText name="nombreCompleto" class="form-control" value="#{ingresoClienteBeans.to.clienteActualizar.nombreCompleto}" />
							</div>
							<div class="form-group">
								<label for="exampleFormControlInput1">RUT</label>
								  <h:inputText name="rut" value="#{ingresoClienteBeans.to.clienteActualizar.rut}"	class="form-control" id="frut"	placeholder="Ingrese el RUT del Agente"/>
							</div>
							<div class="form-group">
								<label for="exampleFormControlInput1">Banco: </label>  
								
								<p:selectOneMenu  value="#{ingresoClienteBeans.to.clienteActualizar.banco}"  >
									<f:selectItems value="#{ingresoClienteBeans.to.listaBancos}"    var="banco"    itemLabel="#{banco.codBanco}"   itemValue="#{banco.glosa}"/> 
								</p:selectOneMenu>
								
							</div>
							<div class="form-group">
								<label for="exampleFormControlInput1">CTA. Corriente</label> <h:inputText
									type="text" name="c_corriente" class="form-control" value="#{ingresoClienteBeans.to.clienteActualizar.c_corriente}"
									placeholder="Ingrese la cuenta corriente"/>
							</div>
							<div class="form-group">
								<label for="exampleFormControlInput1">Monto Max. por
									cliente</label>  <h:inputText type="number" name="monto_maximo_prestamo" value="#{ingresoClienteBeans.to.clienteActualizar.monto_maximo_prestamo}"
									class="form-control" id="fmonto"
									placeholder="Ingrese el monto Maximo"/>
							</div>

							<div class="botones-derecha">
								<p:commandButton value="Guardar" actionListener="#{ingresoClienteBeans.actualizarCliente}"  onclick="PF('dlg2').hidden();" styleClass="btn btn-primary"  />
								<p:commandButton value="Cancelar"   onclick="PF('dlg2').hidden();" styleClass="btn btn-primary"   />
								
							</div>
					</h:form>
</p:dialog> 

	
    </ui:define>
</ui:composition>

